import{a as e}from"./pb-mixin-DHoWQheB.js";let t,n=0;const s=new Map;function i(e){t=e,n++,s.clear()}function r(e,n){return t?t(e,n):e}const c=(e,t)=>r(e,t);"undefined"!=typeof document&&document.addEventListener("pb-i18n-update",e=>{var i;const r=null===(i=e.detail)||void 0===i?void 0:i.t;r&&r!==t&&(t=r),n++,s.clear()});class o extends e{static get properties(){return Object.assign(Object.assign({},super.properties),{},{key:{type:String},options:{type:Object},_translated:{type:String}})}constructor(){super(),this.key="missing-key",this.options=null,this._translated=null,this._fallback="",this._onI18nUpdate=()=>this._recompute(),this._recomputeTimer=null}connectedCallback(){super.connectedCallback(),this._capturedFallback||(this._fallback=this.innerHTML,this._capturedFallback=!0),this.innerHTML="","undefined"!=typeof document&&document.addEventListener("pb-i18n-update",this._onI18nUpdate),this._scheduleRecompute()}disconnectedCallback(){"undefined"!=typeof document&&document.removeEventListener("pb-i18n-update",this._onI18nUpdate),this._recomputeTimer&&(clearTimeout(this._recomputeTimer),this._recomputeTimer=null),super.disconnectedCallback()}updated(e){(e.has("key")||e.has("options"))&&this._scheduleRecompute()}_scheduleRecompute(){this._recomputeTimer||(this._recomputeTimer=setTimeout(()=>{this._recomputeTimer=null,this._recompute()},20))}_recompute(){const e=this.options||{},t=`${n}::${this.key}::${JSON.stringify(e)}`;if(s.has(t))return void(this._translated=s.get(t));const i=r(this.key,e),c=i&&i!==this.key?i:null;s.set(t,c),this._translated=c}render(){return this._translated??this._fallback}createRenderRoot(){return this}}customElements.define("pb-i18n",o);export{r as g,i,c as t};
